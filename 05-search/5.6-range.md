---
description: >-
  ì´ ë¬¸ì„œì˜ í—ˆê°€ë˜ì§€ ì•Šì€ ë¬´ë‹¨ ë³µì œë‚˜ ë°°í¬ ë° ì¶œíŒì„ ê¸ˆì§€í•©ë‹ˆë‹¤. ë³¸ ë¬¸ì„œì˜ ë‚´ìš© ë° ë„í‘œ ë“±ì„ ì¸ìš©í•˜ê³ ì í•˜ëŠ” ê²½ìš° ì¶œì²˜ë¥¼ ëª…ì‹œí•˜ê³ 
  ê¹€ì¢…ë¯¼(kimjmin@gmail.com)ì—ê²Œ ì‚¬ìš© ë‚´ìš©ì„ ì•Œë ¤ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.
---

# 5.6 ë²”ìœ„ ì¿¼ë¦¬ - Range Query

  ì§€ê¸ˆê¹Œì§€ëŠ” ë¬¸ìì—´ í•„ë“œë“¤ì˜ ê²€ìƒ‰ì— ëŒ€í•´ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ElasticsearchëŠ” ì´ ì™¸ì—ë„ **ìˆ«ì**ë‚˜ **ë‚ ì§œ** í˜•ì‹ë“¤ì˜ ì €ì¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ìˆ«ì, ë‚ ì§œ í˜•ì‹ì€ **range** ì¿¼ë¦¬ë¥¼ ì´ìš©í•´ì„œ ê²€ìƒ‰ì„ í•©ë‹ˆë‹¤.

  **range** ì¿¼ë¦¬ì˜ ì˜ˆì œë¥¼ ìœ„í•´ ë¨¼ì € ì•„ë˜ì˜ **phones** ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•˜ê² ìŠµë‹ˆë‹¤.

{% code-tabs %}
{% code-tabs-item title="bulk ëª…ë ¹ìœ¼ë¡œ phone ì¸ë±ìŠ¤ ì¶”ê°€" %}
```javascript
POST phones/_bulk
{"index":{"_id":1}}
{"model":"Samsung GalaxyS 5","price":475,"date":"2014-02-24"}
{"index":{"_id":2}}
{"model":"Samsung GalaxyS 6","price":795,"date":"2015-03-15"}
{"index":{"_id":3}}
{"model":"Samsung GalaxyS 7","price":859,"date":"2016-02-21"}
{"index":{"_id":4}}
{"model":"Samsung GalaxyS 8","price":959,"date":"2017-03-29"}
{"index":{"_id":5}}
{"model":"Samsung GalaxyS 9","price":1059,"date":"2018-02-25"}
```
{% endcode-tabs-item %}
{% endcode-tabs %}

\( ğŸ¤“ ìœ„ ì˜ˆì œ ë°ì´í„°ëŠ” ì‹¤ì œ ìƒí’ˆ ì •ë³´ì™€ ì•„ë¬´ëŸ° ê´€ë ¨ì´ ì—†ìŠµë‹ˆë‹¤ \)

range ì¿¼ë¦¬ëŠ” `range : { <í•„ë“œëª…>: { <íŒŒë¼ë©”í„°>:<ê°’> } }` ìœ¼ë¡œ ì…ë ¥ë©ë‹ˆë‹¤. range ì¿¼ë¦¬ íŒŒë¼ë©”í„°ëŠ” ì•„ë˜ì˜ 4ê°€ì§€ê°€ ìˆìŠµë‹ˆë‹¤. 

* **gte** \(Greater-than or equal to\) - ì´ìƒ \(ê°™ê±°ë‚˜ í¼\)
* **gt** \(Greater-than\) â€“ ì´ˆê³¼ \(í¼\)
* **lte** \(Less-than or equal to\) - ì´í•˜ \(ê°™ê±°ë‚˜ ì‘ìŒ\)
* **lt** \(Less-than\) - ë¯¸ë§Œ \(ì‘ìŒ\)

  ë‹¤ìŒì€ phone ì¸ë±ìŠ¤ì—ì„œ **price** í•„ë“œ ê°’ì´ **700 ì´ìƒ**, **900 ë¯¸ë§Œ**ì¸ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="request" %}
{% code-tabs %}
{% code-tabs-item title="price ê°’ì´ 700 ì´ìƒ 900 ë¯¸ë§Œì¸ ë°ì´í„° ê²€ìƒ‰" %}
```javascript
GET phones/_search
{
  "query": {
    "range": {
      "price": {
        "gte": 700,
        "lt": 900
      }
    }
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}

{% tab title="response" %}
{% code-tabs %}
{% code-tabs-item title="price ê°’ì´ 700 ì´ìƒ 900 ë¯¸ë§Œì¸ ë°ì´í„° ê²€ìƒ‰ ê²°ê³¼" %}
```javascript
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "2",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 6",
          "price" : 795,
          "date" : "2015-03-15"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "3",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 7",
          "price" : 859,
          "date" : "2016-02-21"
        }
      }
    ]
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}
{% endtabs %}

  price ê°’ì´ 700ê³¼ 900 ì‚¬ì´ì¸ `"price" : 795`, `"price" : 859` ë‘ê°œì˜ ê²°ê³¼ê°€ ë¦¬í„´ ë˜ì—ˆìŠµë‹ˆë‹¤.

### ë‚ ì§œ ê²€ìƒ‰

  ë‚ ì§œë„ ìˆ«ìì™€ ë§ˆì°¬ê°€ì§€ë¡œ **range** ì¿¼ë¦¬ì˜ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ Elasticsearch ì—ì„œ ë‚ ì§œ ê°’ì€ 2016-01-01 ë˜ëŠ” 2016-01-01T10:15:30 ê³¼ ê°™ì´ JSON ì—ì„œ ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” **ISO8601** í˜•ì‹ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë‹¤ìŒì€ date í•„ë“œì˜ ë‚ ì§œê°€ 2016ë…„ 1ì›” 1ì¼ ì´í›„ì¸ ë„íë¨¼íŠ¸ë“¤ì„ ê²€ìƒ‰í•˜ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="request" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ì´í›„ì¸ ë°ì´í„° ê²€ìƒ‰" %}
```javascript
GET phones/_search
{
  "query": {
    "range": {
      "date": {
        "gt": "2016-01-01"
      }
    }
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}

{% tab title="response" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ì´í›„ì¸ ë°ì´í„° ê²€ìƒ‰ ê²°ê³¼" %}
```javascript
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 3,
      "relation" : "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "3",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 7",
          "price" : 859,
          "date" : "2016-02-21"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "4",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 8",
          "price" : 959,
          "date" : "2017-03-29"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "5",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 9",
          "price" : 1059,
          "date" : "2018-02-25"
        }
      }
    ]
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}
{% endtabs %}

  ì¿¼ë¦¬ì˜ ë‚ ì§œ í¬ë§·ì„ ë‹¤ë¥´ê²Œ í•˜ê³  ì‹¶ìœ¼ë©´ `format` ì˜µì…˜ì˜ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. `||` ì„ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ê°’ì˜ ì…ë ¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì•„ë˜ëŠ” date í•„ë“œì˜ ê°’ì´ **2015ë…„ 12ì›” 31ì¼** ë¶€í„° **2018ë…„ ì´ì „** ì‚¬ì´ì— ìˆëŠ” ê°’ë“¤ì„ ê²€ìƒ‰í•˜ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="request" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ~ 2018-01-01 ì‚¬ì´ì˜ ë°ì´í„° ê²€ìƒ‰" %}
```javascript
GET phones/_search
{
  "query": {
    "range": {
      "date": {
        "gt": "31/12/2015",
        "lt": "2018",
        "format": "dd/MM/yyyy||yyyy"
      }
    }
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}

{% tab title="response" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ~ 2018-01-01 ì‚¬ì´ì˜ ë°ì´í„° ê²€ìƒ‰ ê²°ê³¼" %}
```javascript
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "3",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 7",
          "price" : 859,
          "date" : "2016-02-21"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "4",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 8",
          "price" : 959,
          "date" : "2017-03-29"
        }
      }
    ]
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}
{% endtabs %}

  ë‚ ì§œë¥¼ ê²€ìƒ‰ í•  ë•ŒëŠ” ê²€ìƒ‰í•˜ëŠ” í˜„ì¬ ì‹œê°„ì„ ê°€ì ¸ì˜¤ëŠ” ì˜ˆì•½ì–´ `now`ì™€ `y`\(ë…„\), `M`\(ì›”\), `d`\(ì¼\), `h`\(ì‹œ\), `m`\(ë¶„\), `s`\(ì´ˆ\), `w`\(ì£¼\) ë“±ì˜ ì‚¬ìš©ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ë‹¤ìŒì€ **date**ì˜ ê°’ì´ **2016ë…„ 1ì›” 1ì¼ì—ì„œ 6ê°œì›” í›„**ì¸ ë‚  ë¶€í„° **ì˜¤ëŠ˜ë³´ë‹¤ 365ì¼ ì „**ì¸ ë‚  ì‚¬ì´ì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬ì…ë‹ˆë‹¤. ì°¸ê³ ë¡œ í•„ìê°€ ì•„ë˜ ì˜ˆì œë¥¼ ì‹¤í–‰í•œ ë‚ ì§œëŠ” **2019ë…„ 9ì›” 3ì¼** ì…ë‹ˆë‹¤.

{% tabs %}
{% tab title="request" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ì˜ 6ê°œì›” í›„ ë¶€í„° ì˜¤ëŠ˜ \(2019-09-03\) ì˜ 365ì¼ ì´ì „ ì‚¬ì´ ê°’ ê²€ìƒ‰" %}
```javascript
GET phones/_search
{
  "query": {
    "range": {
      "date": {
        "gt": "2016-01-01||+6M",
        "lt": "now-365d"
      }
    }
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}

{% tab title="response" %}
{% code-tabs %}
{% code-tabs-item title="date ê°’ì´ 2016-01-01 ì˜ 6ê°œì›” í›„ ë¶€í„° ì˜¤ëŠ˜ \(2019-09-03\) ì˜ 365ì¼ ì´ì „ ì‚¬ì´ ê°’ ê²€ìƒ‰ ê²°ê³¼" %}
```javascript
{
  "took" : 1,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 2,
      "relation" : "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "4",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 8",
          "price" : 959,
          "date" : "2017-03-29"
        }
      },
      {
        "_index" : "phones",
        "_type" : "_doc",
        "_id" : "5",
        "_score" : 1.0,
        "_source" : {
          "model" : "Samsung GalaxyS 9",
          "price" : 1059,
          "date" : "2018-02-25"
        }
      }
    ]
  }
}
```
{% endcode-tabs-item %}
{% endcode-tabs %}
{% endtab %}
{% endtabs %}

  phones ì¸ë±ìŠ¤ì˜ ì „ì²´ ë„íë¨¼íŠ¸ ì¤‘ 2016ë…„ 1ì›” 1ì¼ì— 6ê°œì›”ì„ ë”í•œ **2016-06-01**ê³¼ ê²€ìƒ‰ì„ ì‹¤í–‰í•œ 2019ë…„ 9ì›” 3ì¼ ë³´ë‹¤ 1ë…„ ì „ì¸ **2018-09-03** ì‚¬ì´ì˜ ê°’ì¸ `"date" : "2017-03-29"`, `"date" : "2018-02-25"` ë‘ ê°œì˜ ê²°ê³¼ê°€ ë¦¬í„´ ë˜ì—ˆìŠµë‹ˆë‹¤.

  ì§€ê¸ˆê¹Œì§€ ì‚´í´ë³¸ **range** ì¿¼ë¦¬ì˜ ìŠ¤ì½”ì–´ëŠ” ëª¨ë‘ `"_score" : 1.0`ë¡œ ë™ì¼í•©ë‹ˆë‹¤. **range** ì¿¼ë¦¬ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì •í™•ë„ë¥¼ ê³„ì‚°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê²€ìƒ‰í•˜ëŠ” ì¡°ê±´ì´ 1000ì´í•˜ë¼ê³  í•  ë•Œ 1000ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ì •í™•ë„ê°€ ë†’ì•„ì§€ê³  1000 ë³´ë‹¤ í¬ê²Œ ë‚®ì•„ì§ˆìˆ˜ë¡ ì •í™•ë„ê°€ ë–¨ì–´ì§€ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ì˜¤ë¡œì§€ í•„ë“œì˜ ê°’ì´ 1000 ë³´ë‹¤ ê°™ê±°ë‚˜ ì‘ì€ì§€ ì•„ë‹Œì§€ì˜ `true` / `false` ì—¬ë¶€ë§Œì„ íŒë‹¨í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ êµ¬ì¸ ì‹œìŠ¤í…œì— ì…ë ¥ëœ êµ¬ì§ìì˜ ì…ì‚¬ ì§€ì› ì¡°ê±´ì´ ë‚˜ì´ 24ì„¸ë¶€í„° 55ì„¸ ì‚¬ì´ë¼ê³  ê°€ì •í–ˆì„ ë•Œ êµ¬ì§ìì˜ ë‚˜ì´ê°€ 35ì„¸ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°€ì¥ ì ìˆ˜ê°€ ë†’ê³  20ëŒ€ì´ê±°ë‚˜ 50ëŒ€ ì´ë©´ ì ìˆ˜ê°€ ë‚®ì•„ì§€ê±°ë‚˜ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. range ì¿¼ë¦¬ëŠ” ìˆ«ì ë˜ëŠ” ë‚ ì§œê°€ ì¿¼ë¦¬ ì¡°ê±´ì— ë¶€í•©í•˜ëŠ”ì§€ ì•„ë‹Œì§€ì˜ ì—¬ë¶€ë§Œì„ ê³„ì‚°í•©ë‹ˆë‹¤.

  ê²½ìš°ì— ë”°ë¼ range ì¿¼ë¦¬ì— ê¸°ì¤€ì ì„ ì£¼ê³  ê¸°ì¤€ì ê³¼ ê°€ê¹ê±°ë‚˜ ë©€ì–´ì§ˆ ìˆ˜ë¡ ìŠ¤ì½”ì–´ë¥¼ ì ìš©í•  í•„ìš”ê°€ ìˆë‹¤ë©´ [function\_score ì¿¼ë¦¬](https://www.elastic.co/guide/en/elasticsearch/reference/7.3/query-dsl-function-score-query.html)ë¥¼ ì‚¬ìš©í•´ì„œ ì¡°ì •ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. function\_score ì¿¼ë¦¬ëŠ” ì´ ì±…ì—ì„œëŠ” ë‹¤ë£¨ì§€ ì•Šìœ¼ë‹ˆ ê³µì‹ ë„íë¨¼íŠ¸ë¥¼ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

### ì •ë¦¬ 

  ì´ë²ˆ ì¥ì—ì„œëŠ” ê²€ìƒ‰ì˜ ê°œë…ê³¼ Elasticsearchì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” **match, match\_phrase, bool, range** ë“±ì˜ ì¿¼ë¦¬ë“¤ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê²€ìƒ‰ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” **ì •í™•ë„\(relevancy\)**, ìŠ¤ì½”ì–´ ì ìˆ˜ì˜ ê°œë…ë“¤ì— ëŒ€í•´ì„œë„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.

  Elastic Stackì€ ê²€ìƒ‰ ì™¸ì—ë„ ë‹¤ì–‘í•œ í˜•íƒœì˜ ë°ì´í„° ë¶„ì„ ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ì§€ë§Œ, ì˜ë¯¸ ìˆëŠ” ë°ì´í„° ë¶„ì„ì„ ìœ„í•´ì„œëŠ” ìœ íš¨í•œ ë°ì´í„°ì˜ ë²”ìœ„ë¥¼ í™•ì¥í•˜ê³  ì¶•ì†Œí•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì— ê¸°ë³¸ ê¸°ëŠ¥ì¸ ê²€ìƒ‰ì„ ì˜ ì´í•´í•˜ëŠ” ê²ƒ ë˜í•œ í•„ìš”í•©ë‹ˆë‹¤. ì´ë²ˆ ì¥ì—ì„œ ì‚´í´ë³¸ ì¿¼ë¦¬ ì™¸ì—ë„ **geo\_point** ë‚˜ **nested** ê°™ì€ íŠ¹ìˆ˜í•œ ë°ì´í„°ë“¤ì„ ê²€ìƒ‰í•˜ëŠ” ì¿¼ë¦¬ë“¤ë„ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° ì¿¼ë¦¬ë“¤ì€ ë’¤ì—ì„œ í•´ë‹¹ ë‚´ìš©ë“¤ì„ ì„¤ëª…í•˜ë©´ì„œ ê°™ì´ ë‹¤ë£¨ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

  ë‹¤ìŒ ì¥ì—ì„œëŠ” í…ìŠ¤íŠ¸ ë°ì´í„°ì˜ ë¶„ì„ê³¼ ìƒ‰ì¸ ê³¼ì •ì— ëŒ€í•´ ë°°ì›Œë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.

